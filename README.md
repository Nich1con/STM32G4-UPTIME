# STM32G4-UPTIME
Библиотека реализующая Arduino-подобные функции realtime для **STM32G4xx**

### Особенности:
- Подходит для микроконтроллеров **STM32G4xx**
- Использует **HSI16** в качестве источника тактирования
- Основана на **LPTIM1**, использует прерывания с частотой 1 мс
- Разрешение: 1 мс & 1 мкс
- Точность зависит от точности HSI16, в пределах +-2%
- За счёт HSI16, не зависит от частоты тактирования CPU

## Внимание!
Библиотека использует **прерывания** LPTIM1,
не запрещайте глобальные прерывания слишком надолго!

## Как использовать?
1. Добавь **stm32g4_uptime.h** в свой проект 
2. Вызови функцию инициализации:
	```
    UPTIME_Init(); 
    ``` 
3. Организация задержек:
	```
	delayMs(100);	// Задержка в 100 мс			
	delayUs(500);	// Задержка в 500 мкс
    ```

4. Получение аптайма для программных таймеров:
	```
	uint32_t tmr0 = millis();
	uint32_t tmr1 = micros();
    ```
5. При необходимости таймер можно оставновить:
	```
	UPTIME_Suspend();	// Остановить перед уходом в сон
    ```
6. Повторный запуск после остановки:
	```
	UPTIME_Resume();	// Запустить после выхода из сна
    ```	
	
## Полный API:
- Системное (инициализация и управление):
	```
	UPTIME_Init();		// Инициализация таймера и прерываний
	UPTIME_DeInit();	// Полный сброс и отключение таймера
	UPTIME_Reset();	// Аппаратный сброс таймера и счетчика millis()/micros()
	UPTIME_Suspend();	// Приостановка таймера (без сброса)
	UPTIME_Resume();	// Возобновление таймера
    ```
- Время:
	```
	millis();		// Аптайм в мс
	micros();		// Аптайм в мкс
	delayMs(x);		// Задержка в х мс
	delayUs(x);		// Задержка в х мкс
    ```

	

